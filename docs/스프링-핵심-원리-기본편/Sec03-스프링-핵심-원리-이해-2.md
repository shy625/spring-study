# 3. 스프링 핵심 원리 이해 2 - 객체 지향 원리 적용

## 3.1 새로운 할인 정책 개발

- 애자일 소프트웨어 개발 선언 - [링크](https://agilemanifesto.org/iso/ko/manifesto.html)

- 테스트 코드를 작성할 때, 성공하는 케이스도 중요하지만 실패하는 케이스 또한 중요하다.

## 3.2 새로운 할인 정책 적용과 문제점

- DIP(Dependency Inversion Principle)
    - 추상화에 의존해야지 구체화에 의존하면 안된다.
    - 구현 클래스가 아닌 인터페이스에 의존해야 한다.
- OCP(Open-Closed Principle)
    - 확장에는 열려 있고, 변경에는 닫혀 있어야 한다.
    - 기존 코드의 변경 없이 확장이 가능해야 한다.

### 문제점

- 역할과 구현을 충실히 분리했다 -> O
- 다형성을 활용해 인터페이스와 구현 객체를 분리했다 -> O
- OCP, DIP와 같은 객체 지향 설계 원칙을 준수했다 -> ?
    - DIP 위반<br>
    OrderServiceImple은 인터페이스인 DiscountPolicy와 구현체인 FixDiscountPolicy 둘 다에게 의존하고 있다.
    - OCP 위반<br>
    RateDiscountPolicy로 변경하려면 기존의 OrderServiceImple의 코드도 변경해야 한다.
    ```Java
    DiscountPolicy discountPolicy = new FixDiscountPolicy();
     ```

<br>

- 따라서 DIP, OCP를 지키기 위해서는 인터페이스에만 의존하도록 코드를 변경해야 한다.
```Java
DiscountPolicy discount; // = new FixDiscountPolicy();
```
- 단 이렇게만 하면 선언한 인터페이스 타입 변수에 할당된 구현체가 없어 NPE이 발생한다.

### 해결책
- 누군가가 OrderServiceImpl에 DiscountPolicy의 구현 객체를 대신 생성하고 주입해주면 된다!